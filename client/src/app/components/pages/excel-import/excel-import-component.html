<div class="excel-import-container">
  <h2>ðŸ“‚ Importar movimientos bancarios</h2>

  <div class="upload-section">
    <label class="file-label">
      <input type="file" accept=".xlsx, .xls" (change)="onFileSelected($event)" hidden />
      <button class="btn btn-primary">Seleccionar Excel</button>
    </label>
    <span *ngIf="fileName">{{ fileName }}</span>
  </div>

  <div *ngIf="loading" class="loading">
    <p>Cargando y procesando archivo...</p>
  </div>

  <div *ngIf="!loading && (incomes.length || expenses.length)">
    <h3>ðŸ’° Ingresos detectados: {{ incomes.length }}</h3>
    <table>
      <thead>
        <tr>
          <th>Fecha</th>
          <th>DescripciÃ³n</th>
          <th>Importe</th>
          <th>CategorÃ­a</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let inc of incomes">
          <td>{{ inc.date }}</td>
          <td>{{ inc.name }}</td>
          <td class="income">+{{ inc.amount | number:'1.2-2' }} â‚¬</td>
          <td>{{ inc.category_id }}</td>
        </tr>
      </tbody>
    </table>

    <h3>ðŸ’¸ Gastos detectados: {{ expenses.length }}</h3>
    <table>
      <thead>
        <tr>
          <th>Fecha</th>
          <th>DescripciÃ³n</th>
          <th>Importe</th>
          <th>CategorÃ­a</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let exp of expenses">
          <td>{{ exp.date }}</td>
          <td>{{ exp.name }}</td>
          <td class="expense">-{{ exp.amount | number:'1.2-2' }} â‚¬</td>
          <td>{{ exp.category_id }}</td>
        </tr>
      </tbody>
    </table>

    <button class="btn btn-success" (click)="saveToDatabase()">
      Guardar en Base de Datos
    </button>
  </div>
</div>

