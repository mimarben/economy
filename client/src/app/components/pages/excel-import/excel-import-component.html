<div class="excel-import-container">
  <h2>ðŸ“‚ Importar movimientos bancarios</h2>

  <div class="upload-section">
    <input
      type="file"
      accept=".xlsx, .xls"
      (change)="onFileSelected($event)"
      #fileInput
      style="display: none;"
    />

    <button
      class="btn btn-primary"
      (click)="fileInput.click()"
      [disabled]="loading"
    >
      <span *ngIf="!loading">Seleccionar Excel</span>
      <span *ngIf="loading">Procesando...</span>
    </button>

    <span class="file-name-display" *ngIf="fileName">{{ fileName }}</span>
  </div>

  <div *ngIf="loading" class="loading">
    <p>Cargando y procesando archivo...</p>
  </div>

  <div *ngIf="!loading && (incomes.length || expenses.length)" class="results-section">
    <h3>ðŸ’° Ingresos detectados: {{ incomes.length }}</h3>
    <table>
      <thead>
        <tr>
          <th>Fecha</th>
          <th>DescripciÃ³n</th>
          <th>Importe</th>
          <th>CategorÃ­a</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let inc of incomes">
          <td>{{ inc.date | date: 'dd/MM/yyyy' }}</td>
          <td>{{ inc.name }}</td>
          <td class="income">+{{ inc.amount | number:'1.2-2' }} â‚¬</td>
          <td>{{ inc.category_id }}</td>
        </tr>
      </tbody>
    </table>

    <h3>ðŸ’¸ Gastos detectados: {{ expenses.length }}</h3>
    <table>
      <thead>
        <tr>
          <th>Fecha</th>
          <th>DescripciÃ³n</th>
          <th>Importe</th>
          <th>CategorÃ­a</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let exp of expenses">
          <td>{{ exp.date | date: 'dd/MM/yyyy' }}</td>
          <td>{{ exp.name }}</td>
          <td class="expense">-{{ exp.amount | number:'1.2-2' }} â‚¬</td>
          <td>{{ exp.category_id }}</td>
        </tr>
      </tbody>
    </table>

    <button class="btn btn-success save-button" (click)="saveToDatabase()">
      Guardar en Base de Datos ({{ incomes.length + expenses.length }} transacciones)
    </button>
  </div>
</div>
